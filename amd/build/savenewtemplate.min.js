define("mod_planner/savenewtemplate",["exports","core/modal_factory","./modal_save_new_template","./events","core/modal_events","core/ajax","core/notification"],(function(_exports,_modal_factory,_modal_save_new_template,_events,_modal_events,_ajax,_notification){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Creates the modals for the guide tips.
   *
   * @author      Jay Churchward <jay@brickfieldlabs.ie>
   * @copyright   2021 Brickfield Education Labs <jay@brickfieldlabs.ie>
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modal_factory=_interopRequireDefault(_modal_factory),_modal_save_new_template=_interopRequireDefault(_modal_save_new_template),_events=_interopRequireDefault(_events),_modal_events=_interopRequireDefault(_modal_events),_ajax=_interopRequireDefault(_ajax),_notification=_interopRequireDefault(_notification);const show=async function(rootNode){let{focusOnClose:focusOnClose=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const modal=await _modal_factory.default.create({type:_modal_save_new_template.default.TYPE});modal.show(),modal.getRoot().on(_modal_events.default.hidden,(()=>{modal.destroy();try{focusOnClose.focus()}catch(e){}})),modal.getRoot().on(_events.default.savenewtemplate,(e=>{const templateName=document.getElementById("newTemplateName").value,disclaimer=document.getElementById("id_disclaimereditable").innerHTML,stepName=[],stepAllocation=[],stepDescription=[];for(let i=0;i<repeatNo;i++){"".concat("id_stepname_",+i);stepName.push(document.getElementById("".concat("id_stepname_",+i)).value),stepAllocation.push(document.getElementById("id_stepallocation_"+i).value),stepDescription.push(document.getElementById("id_stepdescription_"+i+"editable").innerHTML)}_ajax.default.call([{methodname:"mod_planner_save_new_template",args:{name:templateName,disclaimer:disclaimer,personal:isPersonal,stepname:stepName,stepallocation:stepAllocation,stepdescription:stepDescription,optionrepeats:repeatNo},fail:_notification.default.exception}])}))},init=(templatedata,repeatno,personal)=>{templateData=templatedata,repeatNo=repeatno,isPersonal=personal,init.initialised||(init.initialised=!0,(templateData=>{document.addEventListener("click",(e=>{const trigger=e.target.closest("#id_savenewtemplate");trigger&&(e.preventDefault(),show(trigger,{focusOnClose:e.target},templateData,repeatNo))}))})())};_exports.init=init;let templateData="",repeatNo=0,isPersonal="";init.initialised=!1}));

//# sourceMappingURL=savenewtemplate.min.js.map