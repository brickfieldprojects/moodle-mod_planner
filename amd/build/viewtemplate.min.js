define("mod_planner/viewtemplate",["exports","core/modal_factory","core/modal_events","core/ajax","core/notification","core/templates"],(function(_exports,_modal_factory,_modal_events,_ajax,_notification,_templates){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Creates the modals viewing the templates.
   *
   * @author      Jay Churchward <jay@brickfieldlabs.ie>
   * @copyright   2021 Brickfield Education Labs <jay@brickfieldlabs.ie>
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events),_ajax=_interopRequireDefault(_ajax),_notification=_interopRequireDefault(_notification),_templates=_interopRequireDefault(_templates);const show=async function(trigger){let{focusOnClose:focusOnClose=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_ajax.default.call([{methodname:"mod_planner_fetch_template_data",args:{templateid:trigger.dataset.templateid},done:async data=>{const modal=await _modal_factory.default.create({title:data.plannertemplate.name,body:_templates.default.render("mod_planner/modal_view_template",data),large:!0});modal.show(),modal.getRoot().on(_modal_events.default.hidden,(()=>{modal.destroy();try{focusOnClose.focus()}catch(e){}}))},fail:_notification.default.exception}])},init=()=>{init.initialised||(init.initialised=!0,document.addEventListener("click",(e=>{const trigger=e.target.closest('[data-action="viewtemplate"]');trigger&&(e.preventDefault(),show(trigger,{focusOnClose:e.target}))})))};_exports.init=init,init.initialised=!1}));

//# sourceMappingURL=viewtemplate.min.js.map